
@{
    ViewData["Title"] = "AddCustomer";
    Layout = "~/Views/Shared/_Layout1.cshtml";
}
<div class="app-page-title">
    <div class="page-title-wrapper">
        <div class="page-title-heading">
            <div class="page-title-icon">
                <i class="lnr-user icon-gradient bg-ripe-malin"> </i>
            </div>
            <div>
                Add Customer 
            </div>
        </div>
    </div>
</div>
<script src="~/Angular/Controllers/CustomerCtrl.js">
</script>
<div class="container-fluid" ng-controller="CustomerCtrl">
    <div class="card">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="card-body">
                <form name="customerProfileForm">
                    <div class="row clearfix">
                        <div class="col-sm-4">
                            <div class="form-group">
                                <div class="form-line">
                                    <label><b>First Name</b> <span class="text-danger">*</span></label>
                                    <input type="text" id="fName" ng-change="validateCustomer()" ng-model="addCustomerProfile.firstName" name="name" required class="form-control" placeholder="Enter First Name" />
                                </div>
                                @*<span style="color:Red" ng-show="lawyerProfile.firstName.$error.required">firstName is required</span>*@
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <div class="form-line">
                                    <label><b>Last Name</b> <span class="text-danger">*</span></label>
                                    <input type="text" id="lName" ng-change="validateCustomer()" ng-model="addCustomerProfile.lastName" name="name" required class="form-control" placeholder="Enter Last Name" />
                                </div>
                                @*<span style="color:Red" ng-show="lawyerProfile.firstName.$error.required">firstName is required</span>*@
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="position-relative form-group">
                                <label for=""><b>Date of Birth</b> <span class="text-danger">*</span></label>
                                <input onchange="validateCust()" id="dob" @*placeholder="mm/dd/yyyy"*@ type="text" class="form-control" data-toggle="datepicker">
                            </div>
                        </div>
                    </div>
                    <div class="row clearfix">
                        <div class="col-sm-4">
                            <div class="form-group">
                                <div class="form-line">
                                    <label><b>Username</b> <span class="text-danger">*</span></label>
                                    <input type="text" id="userName" ng-change="validateCustomer()" ng-model="addCustomerAccount.userName" required class="form-control" placeholder="Enter Username" />
                                </div>
                                <p class="text-danger" style="display:none" id="checkUser">this username is already exit</p>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <div class="form-line">
                                    <label><b>Email</b> <span class="text-danger">*</span></label>
                                    <input type="email" id="email" ng-change="validateCustomer()" ng-model="addCustomerAccount.email" required class="form-control" placeholder="Email Exabcd@gmail.com" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label><b>Password</b> <span class="text-danger">*</span></label>
                                <input id="password"  ng-change="validateCustomer()" name="password" ng-pattern="/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,20}$/" ng-model="addCustomerAccount.passwordHash" type="password" placeholder="Password Ex: Abcde@12" required class="form-control">
                                @* <span toggle="#password-field" class="fa fa-lg fa-eye field-icon toggle-password"></span>*@
                                <span style="color:Red" ng-show="customerProfileForm.password.$error.pattern">[Min 8 char]atleast one special,Uppercase & digit</span>
                            </div>
                        </div>
                    </div>

                    <div class="row clearfix">
                        <div class="col-md-4">
                            <label><b>Gender</b> <span class="text-danger">*</span></label>
                            <div class="input-field col s12" style="padding-left: 0px">
                                <select class="form-control" id="gender" ng-change="validateCustomer()" ng-model="addCustomerProfile.gender" required>
                                    <option value="" disabled selected>Gender</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <div class="form-line">
                                    <label><b>Mobile</b> <span class="text-danger">*</span></label>
                                    <input type="text" id="mobile" ng-change="validateCustomer()" required class="form-control mobile-phone-number" name="contact" ng-model="addCustomerProfile.contact" ng-pattern="/^[0-9]{11,11}$/" placeholder="Contact Ex: 03001234567" />
                                </div>
                                <span style="color:Red" ng-show="customerProfileForm.contact.$error.pattern">enter 11 digits Ex: 03001234567</span>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <div class="form-line">
                                    <label><b>City</b> <span class="text-danger">*</span></label>
                                    <input type="text"  ng-model="addCustomerProfile.city" id="locality" required class="form-control" placeholder="Enter City" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row clearfix">

                        <div class="col-sm-12">
                            <div class="form-group">
                                <div class="form-line">
                                    <label><b>Address</b> <span class="text-danger">*</span></label>
                                    <input type="text" ng-change="validateCustomer()" id="autocomplete" ng-model="addCustomerProfile.address" required class="form-control" placeholder="Enter Address" />
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="row clearfix">
                        <div class="col-sm-4">
                            <label><b>Profile Picture</b> <span class="text-danger">*</span></label>
                            <div class="form-group">
                                <input style="display:none" onchange="validateCust()" type="file" accept="image/*" id="fileInput" oninput="showImage()">
                                <div id="ImageTab" class="center">
                                </div>
                                <img style="width:40px;margin-left: 20px; margin-right:20px" id="selectImageBtn" class="icon-colored pointer" onclick="$('#fileInput').click()" src="~/assets/images/image-upload.png" title="add_image.svg">
                            </div>
                        </div>
                    </div>

                    <div class="row clearfix">

                        <div class="col-md-3">
                        </div>
                        <div class="col-sm-9">
                            <p class="text-danger" style="display:none" id="validation">Please fill all required data</p>
                            <button class="b-2 mr-2 btn btn-shadow btn-info" id="btnSubmit" ng-disabled="btnSubmit" ng-click="addCustomer()" style="margin-left:-1px;float:right">Register</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
@section scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAlVi_v9OYbBjm9zsRtCuoIdC5u6qBENw8&libraries=places&callback=initAutocomplete" async defer></script>
<script>

    var placeSearch, autocomplete;

        var componentForm = {
            locality: 'long_name'
        };

        function initAutocomplete() {
            // Create the autocomplete object, restricting the search predictions to
            // geographical location types.
            autocomplete = new google.maps.places.Autocomplete(
                document.getElementById('autocomplete'), document.getElementById('txtPlaces'), { types: ['geocode'] });
            //autocomplete2 = new google.maps.places.Autocomplete(
            //    document.getElementById('txtPlaces'), { types: ['geocode'] });

            // Avoid paying for data that you don't need by restricting the set of
            // place fields that are returned to just the address components.
            autocomplete.setFields(['address_component']);

            // When the user selects an address from the drop-down, populate the
            // address fields in the form.
            autocomplete.addListener('place_changed', fillInAddress);
        }

        function fillInAddress() {
            // Get the place details from the autocomplete object.
            var place = autocomplete.getPlace();

            for (var component in componentForm) {
                document.getElementById(component).value = '';
                // document.getElementById(component).disabled = false;
            }

            // Get each component of the address from the place details,
            // and then fill-in the corresponding field on the form.
            for (var i = 0; i < place.address_components.length; i++) {
                var addressType = place.address_components[i].types[0];
                if (componentForm[addressType]) {
                    var val = place.address_components[i][componentForm[addressType]];
                    document.getElementById(addressType).value = val;
                }
            }
        }

        // Bias the autocomplete object to the user's geographical location,
        // as supplied by the browser's 'navigator.geolocation' object.
        function geolocate() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    var geolocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };
                    var circle = new google.maps.Circle(
                        { center: geolocation, radius: position.coords.accuracy });
                    autocomplete.setBounds(circle.getBounds());
                });
            }
        }
    function validateCust()
    {
        var fileInput = document.getElementById('fileInput');
        if (
            $("#dob").val() === ""
            || $("#fName").val() === ""
            || $("#lName").val() === ""
            || $("#userName").val() === ""
            || $("#email").val() === ""
            || $("#password").val() === ""
            || $("#contact").val() === ""
            || $("#address").val() === ""
            || $("#locality").val() === ""
            || $("#autocomplete").val() === ""
            || fileInput.files.length === 0
           )
        {
            $("#btnSubmit").attr("disabled", true);
        }
        else { $("#btnSubmit").attr("disabled", false);}
    }
    /////////image

        function showImage() {
            var file_data = $("#fileInput").prop("files")[0];
            $('#ImageTab').append('<img style="cursor:pointer;width:150px;height:150px;" src="' + window.URL.createObjectURL(file_data) + '" alt="' + file_data.name + '" /> <i onclick="ClearFile()" class="fas fa-window-close centerBtn"></i>');
            $('#selectImageBtn').hide();
            validateCust();
            
        }

        function ClearFile() {
            $('#fileInput').val('');
            $('#ImageTab').empty();
            $('#selectImageBtn').show();
            validateCust();
            
        }

        function showImageEdit() {
            var file_data = $("#fileInputEdit").prop("files")[0];
            $('#ImageTabEdit').append('<img style="cursor:pointer" src="' + window.URL.createObjectURL(file_data) + '" alt="' + file_data.name + '" /> <i onclick="ClearFileEdit()" class="fas fa-window-close centerBtn"></i>');
            $('#selectImageBtnEdit').hide();
            validateCust();
            
        }

        function ClearFileEdit() {
            $('#fileInputEdit').val('');
            $('#ImageTabEdit').empty();
            $('#selectImageBtnEdit').show();
            validateCust();
           // angular.element(document.getElementById('LawyerCtrl')).scope().validateIntro();
        }
</script>
   }